#+TITLE: dotfiles

This repo contains my dotfile configuration

I manage the various configuration files in this repo using [[https://www.gnu.org/software/stow/][GNU Stow]].  This allows me to set up symlinks for all of my dotfiles using a single command:

#+begin_src sh
stow -t ~ zsh
stow -t ~ config
stow -t ~ oh-my-zsh-custom
#+end_src

Optional: one-shot bootstrap (clones Oh My Zsh if missing + runs stow):

#+begin_src sh
./script/bootstrap
#+end_src

* Features / memo

** Zsh

- Custom theme lives in =$ZSH_CUSTOM= (default: =~/.config/oh-my-zsh=), so =omz update= works.
- Optional extras installed by `./script/bootstrap`:
  - zsh-autosuggestions
  - fast-syntax-highlighting
  - fzf-tab
- History is shared across shells and stored under XDG state (default: =~/.local/state/zsh/history=).

Quick examples:

#+begin_src sh
# Update Oh My Zsh
omz update

# Run dotfiles health checks
./script/doctor

# fzf helper (defined in zsh/.zshrc)
fe
#+end_src

Keyboard hints:
- autosuggestions: accept suggestion with Right Arrow
- fzf-tab: use TAB completion then pick in the fzf UI

Terminal tip:
- Ctrl-S is enabled for Neovim/tmux (XON/XOFF disabled via `stty -ixon` in `zsh/.zshrc`).

** tmux

- TPM is installed by `./script/bootstrap`.
- Install/update tmux plugins: press `prefix` + I (capital i)

Key cheatsheet (from `config/.config/tmux/tmux.conf`):

#+begin_src text
prefix: C-a

splits:
  prefix + %    split right
  prefix + "    split bottom

move between panes:
  prefix + h/j/k/l
  Alt + Arrow keys

move between windows:
  Shift + Left/Right
  Alt + H/L

copy mode (vi):
  v      start selection
  C-v    rectangle
  y      yank + exit
#+end_src

** Neovim

- This repo commits `config/.config/nvim/lazy-lock.json` so plugin versions are reproducible across machines.
- By default, `./script/bootstrap` will *not* overwrite an existing =~/.config/nvim/lazy-lock.json=.

Use the repo lockfile on a machine that already has a local one:

#+begin_src sh
mv ~/.config/nvim/lazy-lock.json ~/.config/nvim/lazy-lock.json.bak
./script/bootstrap
#+end_src

Key cheatsheet (custom additions in this repo):

#+begin_src text
save:
  à (insert)    save + exit insert
  à (normal)    save
  <C-s>         save (layout-agnostic)
  <leader>w     save (layout-agnostic)

telescope:
  <leader>«     fuzzy find in current buffer
  <leader>sb    fuzzy find in current buffer (layout-agnostic)

copilot:
  <C-l>         accept suggestion

opencode.nvim:
  <C-a>         ask (@this)
  <C-x>         select action
  <C-.>         toggle
  go / goo      send selection/line
#+end_src

Search/replace tips:

#+begin_src text
in file:
  :%s/old/new/gc     replace with confirmation

fast iterative replace:
  /pattern
  cgn                change match
  n + .              next + repeat

UI replace:
  <leader>sr         opens grug-far (if installed)
#+end_src

* Oh My Zsh

This repo does *not* stow into =~/.oh-my-zsh= anymore.

- Keep =~/.oh-my-zsh= as a clean git checkout so =omz update= works.
- Put custom themes/plugins under =$ZSH_CUSTOM= (defaults to =~/.config/oh-my-zsh= in =zsh/.zshrc=).

Install Oh My Zsh (git clone):

#+begin_src sh
git clone https://github.com/ohmyzsh/ohmyzsh.git ~/.oh-my-zsh
#+end_src

Custom theme is shipped by this repo here:
- `oh-my-zsh-custom/.config/oh-my-zsh/themes/adrien-agnoster.zsh-theme`

* Local (per-machine) config

If you need machine-specific paths or secrets, put them in =~/.zshrc.local=.

Example template:
- `zsh/.zshrc.local.example`

* Migration note

If you previously overrode the theme inside =~/.oh-my-zsh=, remove that symlink so OMZ can update.

Typical fix:

#+begin_src sh
rm -f ~/.oh-my-zsh/themes/agnoster.zsh-theme
cd ~/.oh-my-zsh && git checkout -- themes/agnoster.zsh-theme
#+end_src
